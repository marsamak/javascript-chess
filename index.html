<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Chess in Javascript</title>
    <script src="html-chess-board-element.js" type="text/javascript"></script>
    
    <script>
        (() => {
            // **********************
            // ****** PIECE *********
            // **********************
            
            /**
             * Specification of the "Piece" prototype. The actual implementation is located in above javascript file.
             * 
             * @param {symbol} symbol - may be one of following:
             * symbols.PAWN, symbols.ROOK, symbols.KNIGHT, symbols.BISHOP, symbols.QUEEN, symbols.KING
             * 
             * @param {symbol} colour - may be colours.WHITE or colours.BLACK
             */
            let Piece = function(symbol, colour) {
                this.symbol = symbol;

                /*
                 * The "Piece" type comes with some helper fields that are automatically set
                 * and not supposed to be written to. You can use those fields to implement "getMoves"
                 * in your subtypes.
                 */
                
                /** @var {HTMLChessTileElement} _tile - the current tile the piece sits on. */
                this._tile;
                
                /** @var {HTMLChessBoardElement} _board - the current chess board the piece sits on. */
                this._board;
                
                /** @var {Coordinates} _coordinates - the current coordinates the piece sits on */
                this._coordinates;
                
                /** @var {boolean} _isWhite - true, if the piece is white, oterwise false */
                this._isWhite;

                /** @var {boolean} _isBlack - true, if the piece is black, oterwise false */
                this._isBlack;
            }
            
            /**
             * If you click on your piece, this method is called to determine where your piece can move to.
             * You have to override (shadow) this method in your subtypes for it to work.
             *
             * @returns {Coordinates[]} - An array of coordinates the piece is supposed to be able to move to.
             */
            Piece.prototype.getMoves = function () {
                // In the "Piece" type, this method isn't implemented and will throw an error.
            }
            
            // **********************
            // **** CHESS BOARD *****
            // **********************

            /**
             * Specification of the chess board. The actual implementation is in the javascript file above.
             */
            let HTMLChessBoardElement = function () {}

            /**
             * This method will return a tile at the given coordinates. Example call:
             * chessBoard.getTileAt(new Coordinates(3, 4));
             *
             * @param {Coordinates} coordinates
             * @returns {HTMLChessTileElement}
             */
            HTMLChessBoardElement.prototype.getTileAt = function (coordinates) {}

            /**
             * This method will return a piece at the given coordinates. Example call:
             * chessBoard.getPieceAt(new Coordinates(3, 4));
             *
             * @param {Coordinates} coordinates
             * @returns {Piece}
             */
            HTMLChessBoardElement.prototype.getPieceAt = function (coordinates) {}

            // **********************
            // ** CHESS BOARD TILE **
            // **********************

            /**
             * Specification of a tile. The actual implementation is in the javascript file above.
             */
            let HTMLChessTileElement = function () {
                /**
                 * The piece that sits on the tile. You can set this property as you like. Example:
                 * 
                 * tile.piece = myRook;
                 * 
                 * To clear the tile, use following:
                 * 
                 * tile.piece = null;
                 *
                 * @var {Piece} piece
                 */
                this.piece;
                
                /** @var {Coordinates} coordinates - The coordinates of the tile. */
                this.coordinates;
            }

            // **********************
            // **** COORDINATES *****
            // **********************
            
            /**
             * Specification of the Coordinates type. The actual implementation is in the javascript file above.
             * This is a simple type consisting of an x value and a y value.
             * @param {number} x
             * @param {number} y
             */
            let Coordinates = function (x, y) {
                this.x = x;
                this.y = y;
            }
        });
    </script>
</head>
<body>
    <h1>Chess in Javascript</h1> 
   
    <chess-board id="chess-board"></chess-board>

    <script type="text/javascript">
        /** @var {HTMLChessBoardElement} chessBoard */
        const chessBoard = document.getElementById('chess-board');
        
        function Pawn(colour) {
            Piece.call(this, symbols.PAWN, colour);
        }
        Pawn.prototype = Object.create(Piece.prototype);
        Pawn.prototype.constructor = Pawn;

        Pawn.prototype.getMoves = function () {
            let yDirection = 0;
            switch(this.colour) {
                case colours.WHITE:
                    yDirection = 1;
                    break;
                case colours.BLACK:
                    yDirection = -1;
                    break;
            }
            
            let newX = this._coordinates.x;
            let newY = this._coordinates.y + yDirection;
            
            if (newY >= 8 || newY < 0) {
                return;
            } else {
                return [new Coordinates(newX, newY)];
            }
        }
    </script>
</body>
</html>